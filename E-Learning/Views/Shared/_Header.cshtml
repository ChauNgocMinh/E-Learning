<style>
    .top-bar {
        background: #f8f9fa;
        padding-top: 5px;
        padding-bottom: 5px;
    }

    .navbar-main {
        top: 0;
        z-index: 1030;
        background: #8dd8b5;
    }

    .navbar-nav .nav-link.active {
        background-color: #fff !important;
        border-radius: 8px 8px 0px 0px ;
        color: #ff6d3a !important;
    }

    .navbar-collapse .navbar-nav .nav-link:hover{
        background-color: #fbefe4 !important;
        border-radius: 8px 8px 0px 0px;
        color: #ff6d3a !important;
    }

    .offcanvas-start {
        width: 250px;
    }

    .logo {
        font-size: 20px;
        font-weight: bold;
        color: #007bff;
    }

    .btn-login {
        color: white !important;
        background: #ff6d3a;
        border-radius: 32px;
    }

    .btn-login:hover {
        background: #cc3a07;
    }

    .hidden {
        display: none;
    }

    .active-list {
        display: flex;
    }

    .navbar-nav.hidden:empty {
        display: none !important;
    }

    .navbar-nav.hidden li:empty {
        display: none;
    }

    #list-item-default {
        min-height: 40px;
    }

    .active-list {
        display: flex; /* hoặc block */
        min-height: 40px; /* chiều cao nav trắng tối thiểu */
        width: 100%; /* kéo ngang */
        background: #fff; /* màu nền trắng */
    }
</style>
<div class="top-bar d-flex justify-content-between align-items-center container-system">
    <img class="mx-1" height="37" width="80" src="/img/logo/Logo-power.svg" alt="icon">
    <div class="d-none d-md-block">
        <ul class="navbar-nav flex-row">
            <li class="nav-item d-flex align-items-center me-2">
                <a class="fs-7 fw-bold" href="/">Cách luyện tập FREE</a>
            </li>
            <li class="nav-item d-flex align-items-center me-2">
                <a class="fs-7 fw-bold" href="/">Group luyện Writing</a>
            </li>
            @if (User.Identity.IsAuthenticated)
            {
                <li class="nav-item me-2">
                    <span class="nav-link text-dark">Hello, @User.Identity.Name</span>
                </li>
                <li class="nav-item">
                    <form asp-controller="Auth" asp-action="Logout" method="post" class="d-inline">
                        <button type="submit" class="btn btn-outline-danger btn-sm">Logout</button>
                    </form>
                </li>
            }
            else
            {
                <li class="nav-item me-2">
                    <a class="btn btn-login fs-8 fw-bold px-3 py-2" asp-controller="Auth" asp-action="Login">Đăng nhập</a>
                </li>
            }
        </ul>
    </div>
</div>
<nav class="navbar navbar-main p-0 navbar-expand-md" aria-label="Main navigation">
    <div class="container-system w-100">
        <div class="collapse navbar-collapse">
            <ul id="top-menu" class="navbar-nav align-items-center mt-2">
                <li class="nav-item d-flex align-items-center me-3">
                    <a class="nav-link fs-7 fw-bold
         @(ViewContext.RouteData.Values["controller"]?.ToString() == "Home" && ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")"
                       asp-controller="Home" asp-action="Index">
                        <i class="bi bi-house-door-fill me-1 text-success"></i> Trang chủ
                    </a>
                </li>

                <li class="nav-item d-flex align-items-center me-3"><div style="width:1px;height:1rem;background:#808890"></div></li>

                <li class="nav-item d-flex align-items-center me-3" data-target="list-item-1">
                    <a class="nav-link fs-7 fw-bold
         @(ViewContext.RouteData.Values["controller"]?.ToString() == "Home" && ViewContext.RouteData.Values["action"]?.ToString() == "Example" ? "active" : "")"
                       asp-controller="Home" asp-action="Example">
                        <i class="bi bi-lightning-charge-fill me-1 text-warning"></i> Khoá học E-learning
                    </a>
                </li>

                <li class="nav-item d-flex align-items-center me-3"><div style="width:1px;height:1rem;background:#808890"></div></li>

                <li class="nav-item d-flex align-items-center me-3" data-target="list-item-2">
                    <a class="nav-link fs-7 fw-bold
         @(ViewContext.RouteData.Values["controller"]?.ToString() == "Home" && ViewContext.RouteData.Values["action"]?.ToString() == "Courses" ? "active" : "")"
                       asp-controller="Home" asp-action="Courses">
                        <i class="bi bi-display me-1 text-primary"></i> Khoá học E-learning
                    </a>
                </li>

                <li class="nav-item d-flex align-items-center me-3"><div style="width:1px;height:1rem;background:#808890"></div></li>

                <li class="nav-item d-flex align-items-center me-3" data-target="list-item-3">
                    <a class="nav-link fs-7 fw-bold text-dark" href="#">
                        <i class="bi bi-file-earmark-text me-1 text-success"></i> Bài mẫu Writing 8.0+
                    </a>
                </li>

                <li class="nav-item d-flex align-items-center me-3"><div style="width:1px;height:1rem;background:#808890"></div></li>

                <li class="nav-item d-flex align-items-center" data-target="list-item-4">
                    <a class="nav-link fs-7 fw-bold text-dark" href="#">
                        <i class="bi bi-patch-question me-1 text-success"></i> YouPass là gì?
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<nav class="navbar p-0 navbar-expand-md" aria-label="Main navigation" id="subnav">
    <div class="container-system w-100">
        <div class="collapse navbar-collapse">
            <ul id="list-item-empty" class="navbar-nav hidden"></ul>

            <ul id="list-item-1" class="navbar-nav hidden">
                <li class="nav-item"><a class="nav-link">Sub menu 1</a></li>
            </ul>

            <ul id="list-item-2" class="navbar-nav hidden">
                <li class="nav-item"><a class="nav-link">Sub menu 2</a></li>
            </ul>

            <ul id="list-item-3" class="navbar-nav hidden">
                <li class="nav-item"><a class="nav-link">Sub menu 3</a></li>
            </ul>
        </div>
    </div>
</nav>
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="#">Trang chủ</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Khoá học E-learning</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Luyện tập 4 kỹ năng</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Bài mẫu Writing 8.0+</a></li>
            <li class="nav-item"><a class="nav-link" href="#">YouPass là gì?</a></li>
        </ul>
        <hr>
        <button class="btn btn-outline-primary w-100">Login</button>
    </div>
</div>

<script>
      let defaultList = null;

    function hideAll() {
      document.querySelectorAll('#subnav [id^="list-item-"], #subnav #list-item-empty').forEach(el => {
        el.classList.add('hidden');
        el.classList.remove('active-list');
      });
    }

    function showListByTargetId(targetId) {
      const targetEl = targetId ? document.getElementById(targetId) : null;
      const list = targetEl || document.getElementById('list-item-empty');
      if (list) {
        list.classList.remove('hidden');
        list.classList.add('active-list');
      }
      return list;
    }

    window.addEventListener('DOMContentLoaded', () => {
      // Bật tab mặc định theo link active ở menu trên
      const activeLink = document.querySelector('#top-menu .nav-link.active');
      const parentItem = activeLink ? activeLink.closest('.nav-item') : null;
      const targetId = parentItem ? parentItem.getAttribute('data-target') : null;

      hideAll();
      defaultList = showListByTargetId(targetId);
    });

    // CHỈ bind hover cho menu trên
    document.querySelectorAll('#top-menu > .nav-item').forEach(item => {
      item.addEventListener('mouseenter', function () {
        hideAll();
        const targetId = this.getAttribute('data-target');
        showListByTargetId(targetId);
      });
    });

    // Khi rời khỏi khu nav dưới → quay lại tab mặc định
    document.getElementById('subnav').addEventListener('mouseleave', function () {
      hideAll();
      if (defaultList) {
        defaultList.classList.remove('hidden');
        defaultList.classList.add('active-list');
      }
    });
</script>
